{"version":3,"sources":["../../../widgets/Nuevas_Oportunidades/Widget.js"],"names":["define","declare","BaseWidget","lang","QueryTask","query","graphic","SimpleFillSymbol","Color","SimpleLineSymbol","SpatialReference","baseClass","postCreate","inherited","arguments","console","log","startup","onOpen","ConsultaRenta","map","graphics","clear","RentaTask","Rentaquery","returnGeometry","outFields","where","RentaMin","value","RentaMax","ArrayRenta","execute","hitch","evt","features","length","i","geometriamunis","geometry","add","STYLE_SOLID","STYLE_SHORTDASHDOTDOT","attributes","municpio_1","Municipos_Query","push","ConsultaHabitantes","HabitantesTask","HabitantesQuery","outSpatialReference","Habitantes","geometriaClientes","onClose"],"mappings":"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","file":"Widget.js","sourcesContent":["define(['dojo/_base/declare', 'jimu/BaseWidget',\r\n\"dojo/_base/lang\",\r\n\"esri/tasks/QueryTask\",\r\n\"esri/tasks/query\",\r\n\"esri/graphic\",\r\n\"esri/symbols/SimpleFillSymbol\",\r\n\"esri/Color\",\r\n\"esri/symbols/SimpleLineSymbol\",\r\n\"esri/SpatialReference\"\r\n],\r\nfunction(declare, BaseWidget, lang, QueryTask, query, graphic, SimpleFillSymbol, Color, SimpleLineSymbol, SpatialReference ) {\r\n  //To create a widget, you need to derive from BaseWidget.\r\n  return declare([BaseWidget], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'nuevas-oportunidades',\r\n    // this property is set by the framework when widget is loaded.\r\n    // name: 'Nuevas_Oportunidades',\r\n    // add additional properties here\r\n\r\n    //methods to communication with app container:\r\n    postCreate: function() {\r\n      this.inherited(arguments);\r\n      console.log('Nuevas_Oportunidades::postCreate');\r\n    },\r\n\r\n    startup: function() {\r\n      this.inherited(arguments);\r\n      console.log('Nuevas_Oportunidades::startup');\r\n    },\r\n\r\n    onOpen: function(){\r\n      console.log('Nuevas_Oportunidades::onOpen');\r\n    },\r\n\r\n    ConsultaRenta(){\r\n\r\n      this.map.graphics.clear()\r\n\r\n      var RentaTask = new QueryTask(\"https://localhost:6443/arcgis/rest/services/Proyecto/Servicio_Densidad_Renta_Com_Madrid/MapServer/0\")\r\n\r\n      var Rentaquery = new query();\r\n      Rentaquery.returnGeometry = true;\r\n      Rentaquery.outFields=[\"*\"];\r\n      Rentaquery.where = \"sum_renta_ >\" + this.RentaMin.value\r\n      + \" AND \" + \" sum_renta_ < \" + this.RentaMax.value\r\n\r\n      console.log(\"Query renta:\", Rentaquery)\r\n\r\n      var ArrayRenta = [];\r\n\r\n\r\n      RentaTask.execute(Rentaquery, lang.hitch(this, function(evt){\r\n        \r\n        if(evt.features.length > 0){\r\n\r\n          console.log(evt)          \r\n\r\n          for(i=0; i<evt.features.length; i++){\r\n\r\n\r\n            var geometriamunis = evt.features[i].geometry;           \r\n            this.map.graphics.add(new graphic (geometriamunis, new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID,\r\n            new SimpleLineSymbol (SimpleLineSymbol.STYLE_SHORTDASHDOTDOT,\r\n              new Color([0, 0, 255]), 2),new Color([235, 141, 106,0.25])\r\n              )))\r\n\r\n            console.log(evt.features[i].attributes.municpio_1)\r\n\r\n            var Municipos_Query= evt.features[i].attributes.municpio_1;\r\n\r\n            ArrayRenta.push(Municipos_Query);\r\n\r\n            console.log(\"geometria:\", geometriamunis)\r\n\r\n          }\r\n\r\n          console.log(ArrayRenta);\r\n\r\n        }\r\n\r\n      }))\r\n\r\n\r\n    },\r\n\r\n    ConsultaHabitantes(){\r\n\r\n      this.map.graphics.clear();\r\n\r\n      var HabitantesTask = new QueryTask(\"https://localhost:6443/arcgis/rest/services/Proyecto/Servicio_Densidad_Renta_Com_Madrid/MapServer/0\")\r\n\r\n      var HabitantesQuery = new query()\r\n      HabitantesQuery.returnGeometry = true;\r\n      HabitantesQuery.outFields = [\"municpio_1\", \"sum_pob_to\"];\r\n      HabitantesQuery.outSpatialReference = new SpatialReference (102100)\r\n      HabitantesQuery.where = \"sum_pob_to >=\" + this.Habitantes.value\r\n\r\n      HabitantesTask.execute(HabitantesQuery, lang.hitch(this, function(evt){\r\n\r\n        if(evt.features.length > 0){\r\n\r\n\r\n          for(i=0; i<evt.features.length; i++){\r\n            var geometriaClientes = evt.features[i].geometry;           \r\n           this.map.graphics.add(new graphic (geometriaClientes, new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID,\r\n            new SimpleLineSymbol (SimpleLineSymbol.STYLE_SHORTDASHDOTDOT,\r\n              new Color([0, 255, 0]), 2),new Color([235, 141, 106,0.25])\r\n              )))\r\n          }\r\n\r\n          \r\n          \r\n        }\r\n\r\n\r\n\r\n\r\n      }))\r\n\r\n    },\r\n\r\n    onClose: function(){\r\n      this.map.graphics.clear();\r\n\r\n    },\r\n\r\n    // onMinimize: function(){\r\n    //   console.log('Nuevas_Oportunidades::onMinimize');\r\n    // },\r\n\r\n    // onMaximize: function(){\r\n    //   console.log('Nuevas_Oportunidades::onMaximize');\r\n    // },\r\n\r\n    // onSignIn: function(credential){\r\n    //   console.log('Nuevas_Oportunidades::onSignIn', credential);\r\n    // },\r\n\r\n    // onSignOut: function(){\r\n    //   console.log('Nuevas_Oportunidades::onSignOut');\r\n    // }\r\n\r\n    // onPositionChange: function(){\r\n    //   console.log('Nuevas_Oportunidades::onPositionChange');\r\n    // },\r\n\r\n    // resize: function(){\r\n    //   console.log('Nuevas_Oportunidades::resize');\r\n    // }\r\n\r\n    //methods to communication between widgets:\r\n\r\n  });\r\n\r\n});\r\n"]}